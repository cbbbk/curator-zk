<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>用户管理</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="./css/main.css">
</head>

<body>
    <div id="app">
        <h1>用户管理</h1>
        <template>
            <el-table :data="users" border style="width: 100%">
                <el-table-column prop="username" label="账号">
                </el-table-column>
                <el-table-column prop="userpwd" label="密码">
                </el-table-column>
                <el-table-column prop="truename" label="姓名">
                </el-table-column>
                <el-table-column prop="classid" label="班级">
                </el-table-column>
            </el-table>
            <el-pagination @size-change="handleSizeChange" @current-change="handleCurrentChange"
                :current-page="currentPage" :page-sizes="[1,3,6,10]" :page-size=3
                layout="total, sizes, prev, pager, next, jumper" :total=total>
            </el-pagination>
        </template>
    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script>
    axios.defaults.baseURL = "http://localhost:8080";
    axios.defaults.timeout = 3000;
    const app = new Vue({
        el: "#app",
        data() {
            return {
                users: [],
                currentPage: 1,
                pageSize: 3,
                total: 20
            }
        },
        created() {
            this.query()
        },
        methods: {
            query() {
                axios.get("/users/list", {
                    params: {
                        currentPage: this.currentPage, pageSize: this.pageSize
                    }
                })
                    .then(resp => {
                        this.users = resp.data.users
                        this.total = resp.data.total
                    })
                    .catch(err => console.log(err))
            },
            handleSizeChange(val) {
                this.pageSize = val
                this.query()
            },
            handleCurrentChange(val) {
                this.currentPage = val
                this.query()
            }
        }
    })

</script>

</html>